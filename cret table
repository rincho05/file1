import cx_Oracle
import xml.etree.ElementTree as ET

# establish connection to Oracle database
conn = cx_Oracle.connect(user="your_username", password="your_password", dsn="your_DSN")

# create a cursor object
cur = conn.cursor()

# define the SQL statement to create the table
create_table = """
CREATE TABLE person (
    iin VARCHAR2(12),
    surname VARCHAR2(50),
    name VARCHAR2(50),
    patronymic VARCHAR2(50),
    eng_firstname VARCHAR2(50),
    eng_surname VARCHAR2(50),
    birthdate DATE
)
"""

# execute the SQL statement to create the table
cur.execute(create_table)

# define the XML data to parse
xml_data = '''
<person>
    <iin>660427402182</iin>
    <surname>БИСЕНОВА</surname>
    <name>БАХТЫГУЛ</name>
    <patronymic>ОХАСОВНА</patronymic>
    <engFirstName>BAKHTYGUL</engFirstName>
    <engSurname>BISSENOVA</engSurname>
    <birthDate>1966-04-27</birthDate>
</person>
'''

# parse the XML data and extract the relevant information
root = ET.fromstring(xml_data)
iin = root.find('iin').text
surname = root.find('surname').text
name = root.find('name').text
patronymic = root.find('patronymic').text
eng_firstname = root.find('engFirstName').text
eng_surname = root.find('engSurname').text
birthdate = root.find('birthDate').text

# define the SQL statement to insert the data into the table
insert_data = """
INSERT INTO person(iin, surname, name, patronymic, eng_firstname, eng_surname, birthdate)
VALUES (:iin, :surname, :name, :patronymic, :eng_firstname, :eng_surname, TO_DATE(:birthdate, 'yyyy-mm-dd'))
"""

# execute the SQL statement to insert the data into the table
cur.execute(insert_data, {'iin': iin, 'surname': surname, 'name': name, 'patronymic': patronymic, 
                          'eng_firstname': eng_firstname, 'eng_surname': eng_surname, 'birthdate': birthdate})

# commit the changes to the database
conn.commit()

# close the cursor and connection
cur.close()
conn.close()
